!function(a){function e(e){for(var t,o,r=e[0],n=e[1],i=e[2],s=0,c=[];s<r.length;s++)o=r[s],Object.prototype.hasOwnProperty.call(u,o)&&u[o]&&c.push(u[o][0]),u[o]=0;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(a[t]=n[t]);for(f&&f(e);c.length;)c.shift()();return v.push.apply(v,i||[]),l()}function l(){for(var e,t=0;t<v.length;t++){for(var o=v[t],r=!0,n=1;n<o.length;n++){var i=o[n];0!==u[i]&&(r=!1)}r&&(v.splice(t--,1),e=s(s.s=o[0]))}return e}var o={},u={0:0},v=[];function s(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return a[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=a,s.c=o,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(o,r,function(e){return t[e]}.bind(null,r));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var t=window.webpackJsonp=window.webpackJsonp||[],r=t.push.bind(t);t.push=e,t=t.slice();for(var n=0;n<t.length;n++)e(t[n]);var f=r;v.push([14,1]),l()}([function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.logCell=t.renderCell=t.cellDistance=t.applyForce=t.createCell=void 0;var n=o(7),i=o(4),s=o(1),c=Math.PI/4,a=0;function l(e,t,o){void 0===o&&(o=t.position),e.save(),e.translate(o.x,o.y),e.rotate(s.radians(t.velocity)+c),e.beginPath(),e.arc(0,0,t.radius,0,1.5*Math.PI),e.lineTo(t.radius,-t.radius),e.closePath(),e.lineWidth=5,e.strokeStyle=t.color,e.fillStyle=n.bajarColor(t.color,.5),e.stroke(),e.fill(),e.restore()}t.createCell=function(e){return r({id:a++,color:"#ffffff",position:s.vector(0),velocity:s.vector(0),acceleration:s.vector(0),radius:i.DEFAULT_RADIUS,vision:(e&&e.radius?e.radius:i.DEFAULT_RADIUS)*i.DEFAULT_VISION_FACTOR},e)},t.applyForce=function(e,t){e.acceleration.x+=t.x,e.acceleration.y+=t.y},t.cellDistance=function(e,t){return s.magnitude(s.subtractVectors(e.position,t.position))},t.renderCell=function(e,t,o){var r=t.size,n=o.radius+10,i=o.position;l(e,o),i.x-n<0&&l(e,o,{x:i.x+r.x,y:i.y}),i.x+n>r.x&&l(e,o,{x:i.x-r.x,y:i.y}),i.y-n<0&&l(e,o,{x:i.x,y:i.y+r.y}),i.y+n>r.y&&l(e,o,{x:i.x,y:i.y-r.y})},t.logCell=function(e){return"Cell("+e.id+") "+e.radius+" { pos: "+s.logVector(e.position)+", vel: "+s.logVector(e.velocity)+" }"}},function(e,t,o){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function i(e){var t=e.x,o=e.y;return 0===t&&0===o}function s(e){var t=e.x,o=e.y;return Math.sqrt(Math.pow(t,2)+Math.pow(o,2))}function r(t,o){if(void 0===o&&(o=1),i(t))return n({},t);var r=s(t);return a(function(e){return t[e]*o/r})}function c(e){var t=e.x,o=e.y;return Math.atan2(o,t)}function a(e){var t=e("x"),o=e("y");if("number"==typeof t&&"number"==typeof o)return{x:t,y:o}}Object.defineProperty(t,"__esModule",{value:!0}),t.logVector=t.vectorAxis=t.multiplyVectors=t.subtractVectors=t.sumVectorList=t.sumVectors=t.limitVector=t.getAngle=t.radians=t.normalize=t.magnitude=t.isZero=t.vector=void 0,t.vector=function(e,t){return void 0===t&&(t=e),{x:e,y:t}},t.isZero=i,t.magnitude=s,t.normalize=r,t.radians=c,t.getAngle=function(e){return 180*c(e)/Math.PI},t.limitVector=function(e,t){return t<s(e)?r(e,t):e},t.sumVectors=function(t,o){return a(function(e){return t[e]+o[e]})},t.sumVectorList=function(e){return a(function(t){return e.map(function(e){return e[t]}).reduce(function(e,t){return e+t})})},t.subtractVectors=function(t,o){return a(function(e){return t[e]-o[e]})},t.multiplyVectors=function(t,o){return a(function(e){return t[e]*o})},t.vectorAxis=a,t.logVector=function(e){return"("+e.x+","+e.y+")"}},function(e,v,t){"use strict";(function(r){Object.defineProperty(v,"__esModule",{value:!0}),v.setFilename=v.runTests=v.test=v.isJestTesting=void 0;var s=[],c=document.title,i="";function a(e){var t=e.file,o=e.message,r=e.table,n=e.run;if(r){v.isJestTesting||console.groupCollapsed(o);for(var i=function(e){l(t,o+" ["+e+"]",function(){return n.apply(void 0,r[e])})},s=0;s<r.length;s++)i(s);v.isJestTesting||console.groupEnd()}else l(t,o,n)}function l(t,o,e){if(v.isJestTesting)r.test(o,e);else try{e(),console.log(o+" ðŸŸ¢")}catch(e){throw function(e,t,o){var r;console.log(o+" ðŸ”´"),console.error(t),document.write('\n    <div style="display: flex; align-items:center; justify-content: center; height: 100%">\n    <span>\n      <h1>'+e+"</h1>\n      <h2>"+o+"</h2>\n      <pre>"+(null===(r=t.stack)||void 0===r?void 0:r.replace("\n","<br>"))+"}</pre>\n    </span>\n    </div>\n  ")}(t,e,o),u(),e}}function u(){document.body.style.backgroundColor="#440000"}v.isJestTesting=Boolean(void 0!==r&&r.test),v.test=function(e,t,o){var r=Array.isArray(t)?t:null,n={file:i,message:e,table:r,run:r?o:t};v.isJestTesting?a(n):s.push(n)},v.runTests=function(e){var t=(void 0===e?{}:e).background;u();for(var o="",r=0,n=s;r<n.length;r++){var i=n[r];v.isJestTesting||i.file===o||(console.groupEnd(),o=i.file,console.groupCollapsed(i.file)),a(i)}v.isJestTesting||console.groupEnd(),s.length=0,document.title=c,function(e){void 0===e&&(e="green");document.body.style.backgroundColor=e}(t)},v.setFilename=function(e,t){i=t.replace(e+"/","").replace(/(\.test)?\.ts$/,"")}}).call(this,t(6))},,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FLOCKING_SEPARATION_BORDER_LIMIT=t.FLOCKING_SEPARATION_VISION_LIMIT=t.FLOCKING_SEPARATION_FACTOR=t.FLOCKING_COHESION_FACTOR=t.FLOCKING_ALIGMENENT_FACTOR=t.COLLISION_FRICTION=t.DEFAULT_VISION_FACTOR=t.MAX_FORCE=t.MAX_SPEED=t.DEFAULT_RADIUS=void 0,t.DEFAULT_RADIUS=5,t.MAX_SPEED=10,t.MAX_FORCE=.05,t.DEFAULT_VISION_FACTOR=10,t.COLLISION_FRICTION=.5,t.FLOCKING_ALIGMENENT_FACTOR=.05,t.FLOCKING_COHESION_FACTOR=.001,t.FLOCKING_SEPARATION_FACTOR=.005,t.FLOCKING_SEPARATION_VISION_LIMIT=.5,t.FLOCKING_SEPARATION_BORDER_LIMIT=.1},function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.createTestLulas=void 0;var n=o(0),i=o(9);t.createTestLulas=function(e){return void 0===e&&(e={}),i.default(r({canvas:document.createElement("canvas"),cells:[n.createCell()],worldSize:{x:1e3,y:1e3},behaviors:[]},e))}},,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bajarColor=t.randomColor=void 0;var r=o(8);function n(e){var t=e.r,o=e.g,r=e.b,n=e.a,i=s(Math.round(255*n));return"#"+s(t)+s(o)+s(r)+i}function s(e){var t=Math.round(e).toString(16);return 1===t.length?"0"+t:t}t.randomColor=function(){return n({r:r.random(100,200),g:r.random(100,200),b:r.random(100,200),a:1})},t.bajarColor=function(e,t){var o=function(e){var t=e.match(/#(\w{2})(\w{2})(\w{2})(\w{2})?/);if(!t)throw new Error("DAFUK COLOR IS DIS? "+e);t[0];var o=t[1],r=t[2],n=t[3],i=t[4];return{r:parseInt(o,16),g:parseInt(r,16),b:parseInt(n,16),a:i?parseInt(i,16)/255:1}}(e);return o.r*=t,o.g*=t,o.b*=t,n(o)}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.random=void 0,t.random=function(e,t){void 0===t&&(t=-e);var o=Math.min(e,t),r=Math.max(e,t);return Math.round(Math.random()*(r-o)+o)}},function(e,t,o){"use strict";var u=this&&this.__assign||function(){return(u=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.lulas=void 0;var v=o(0);function r(e){var t=e.canvas,r=e.cells,o=e.behaviors,n=e.worldSize,i=void 0===n?{x:t.width,y:t.height}:n,s=null,c={size:i,look:function(e){return function(t,o){return r.filter(function(e){return e!==t&&v.cellDistance(t,e)<o})}(s,e)}},a=t.getContext("2d"),l=v.renderCell.bind(null,a,c);return{get cells(){return r},step:function(){r=r.map(function(e){var t=u({},e);return s=e,o.forEach(function(e){return e(t,c)}),t})},render:function(){a.strokeStyle="blue",a.fillStyle="blue",a.clearRect(0,0,t.width,t.height),r.forEach(l)}}}t.lulas=r,t.default=r},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.move=void 0;var r=o(4),n=o(4),i=o(1);t.move=function(e){if(!i.isZero(e.acceleration)){var t=i.limitVector(e.acceleration,n.MAX_FORCE),o=i.sumVectors(e.velocity,t);e.velocity=i.limitVector(o,r.MAX_SPEED),e.acceleration=i.vector(0)}e.position.x+=e.velocity.x,e.position.y+=e.velocity.y}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.roundMap=void 0,t.roundMap=function(e,t){var o=t.size;e.position.x<0&&(e.position.x+=o.x),e.position.y<0&&(e.position.y+=o.y),e.position.x>o.x&&(e.position.x-=o.x),e.position.y>o.y&&(e.position.y-=o.y)}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.separationBehavior=t.cohesionBehavior=t.alignementBehavior=t.flocking=void 0;var i=o(4),c=o(0),a=o(4),l=o(1);function r(e,t){var o=t.map(function(e){return e.velocity}).reduce(l.sumVectors,l.vector(0)),r=l.multiplyVectors(o,1/t.length),n=l.subtractVectors(r,e.velocity);return l.multiplyVectors(n,a.FLOCKING_ALIGMENENT_FACTOR)}function n(e,t){var o=t.map(function(e){return e.position}).reduce(l.sumVectors,l.vector(0)),r=l.multiplyVectors(o,1/t.length),n=l.subtractVectors(r,e.position);return l.multiplyVectors(n,a.FLOCKING_COHESION_FACTOR)}function s(t,e){var o=t.vision*a.FLOCKING_SEPARATION_VISION_LIMIT,r=e.filter(function(e){return c.cellDistance(t,e)<o});if(!r.length)return l.vector(0);var n=r.map(function(e){return e.position}).reduce(l.sumVectors,l.vector(0)),i=l.multiplyVectors(n,1/r.length),s=l.subtractVectors(i,t.position);return l.multiplyVectors(s,-1*a.FLOCKING_SEPARATION_FACTOR)}function u(n){return function(e,t){var o=(0,t.look)(e.vision);if(o.length){var r=n(e,o);c.applyForce(e,l.normalize(r,i.MAX_FORCE))}}}t.flocking=u(function(e,t){return l.sumVectorList([r(e,t),n(e,t),s(e,t)])}),t.alignementBehavior=u(r),t.cohesionBehavior=u(n),t.separationBehavior=u(s)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.solidBody=void 0;var c=o(0),n=o(4),i=o(1);function a(e,t,o){var r=i.normalize({x:e.position.x-t.position.x,y:e.position.y-t.position.y},o);e.position.x+=r.x,e.position.y+=r.y,t.position.x-=r.x,t.position.y-=r.y,function(e,t){var o=1-n.COLLISION_FRICTION,r=e.velocity;e.velocity=i.multiplyVectors(t.velocity,o),t.velocity=i.multiplyVectors(r,o)}(e,t)}t.solidBody=function(e,t){for(var o=(0,t.look)(2*e.radius),r=0;r<o.length;r++){var n=o[r],i=n.radius+e.radius,s=c.cellDistance(n,e);s<i&&a(e,n,(i-s)/2)}}},function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,s,c,a){return new(c=c||Promise)(function(t,o){function r(e){try{i(a.next(e))}catch(e){o(e)}}function n(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?t(e.value):function(t){return t instanceof c?t:new c(function(e){e(t)})}(e.value).then(r,n)}i((a=a.apply(e,s||[])).next())})},i=this&&this.__generator||function(o,r){var n,i,s,e,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){c.label=t[1];break}if(6===t[0]&&c.label<s[1]){c.label=s[1],s=t;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(t);break}s[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(o,c)}catch(e){t=[6,e],i=0}finally{n=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),o(15);var s=o(2),c=o(12),a=o(10),l=o(11),u=o(13),v=o(0),f=o(7),p=o(9),d=o(8),h=o(1);n(void 0,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return function(){for(var e={margin:0,padding:0,height:"100%"},t=0,o=[document.documentElement,document.body];t<o.length;t++){var r=o[t];Object.assign(r.style,e)}}(),[4,s.runTests({background:"black"})];case 1:return e.sent(),function(){var e=document.createElement("canvas");document.body.appendChild(e),e.width=window.innerWidth,e.height=window.innerHeight;var t=h.vector(e.width/2,e.height/2),o=p.default({canvas:e,cells:function(e,t){return Array(e).fill(null).map(function(e,t){return t+1}).map(t)}(50,function(e){return v.createCell({position:r({},t),velocity:h.vector(d.random(10),d.random(10)),radius:d.random(5,20),color:f.randomColor()})}),behaviors:[c.flocking,a.move,u.solidBody,l.roundMap]});console.log("Initial state"),console.log(o.cells.map(v.logCell).join("\n")),o.render(),requestAnimationFrame(function e(){o.step(),o.render(),requestAnimationFrame(e)})}(),[2]}})}),setTimeout(function(){document.body.style.backgroundColor="black"})},function(e,t,o){"use strict";var r;(r=o(16)).keys().forEach(r)},function(e,t,o){var r={"./0 - As a developer I want to run tests.test.ts":17,"./1 - As a user I want to see cells.test.ts":18,"./2 - As a user I want to watch them move.test.ts":24,"./3 - As a user I want them to bounce on the corners.test.ts":25,"./3 - As a user I want them to navigate to the other side of the screen.test.ts":27,"./4 - As a user I want to watch them follow flocking behaviour.test.ts":28,"./5 - As a user I want to watch the cell not overlap.test.ts":31};function n(e){var t=i(e);return o(t)}function i(e){if(o.o(r,e))return r[e];var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return Object.keys(r)},n.resolve=i,(e.exports=n).id=16},function(e,n,i){"use strict";(function(e,t){Object.defineProperty(n,"__esModule",{value:!0});var o=i(2),r=!1;o.setFilename(e,t),o.test("Should render something",function(){r=!0,o.isJestTesting||console.log("Tests running...")}),setTimeout(function(){if(!r)throw document.body.style.backgroundColor="yellow",new Error("Test suite not runnig")},0)}).call(this,"user-stories","user-stories/0 - As a developer I want to run tests.test.ts")},function(e,a,l){"use strict";(function(e,t){Object.defineProperty(a,"__esModule",{value:!0});var r=l(3),o=l(0),n=l(2),i=l(5);function s(e){return!e.getContext("2d").getImageData(0,0,e.width,e.height).data.some(function(e){return 0!==e})}function c(e){return e.getContext("2d").__getEvents().every(function(e){return"fillStyle"===e.type||"strokeStyle"===e.type||!/^(fill|stroke)/.test(e.type)})}n.setFilename(e,t),n.test("Should render something",function(){var e=document.createElement("canvas"),t=i.createTestLulas({canvas:e}),o=n.isJestTesting?c:s;t.render(),r(!o(e))}),n.test("Cells should be instanciable",function(){var e=o.createCell();r(e)})}).call(this,"user-stories","user-stories/1 - As a user I want to see cells.test.ts")},,,,,,function(e,r,u){"use strict";(function(e,t){var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});var i=u(3),s=u(10),c=u(0),a=u(1),o=u(2),l=u(5);o.setFilename(e,t),o.test("I should be able to create a cell with predefined parameters",[[a.vector(0)],[a.vector(1)],[a.vector(2)]],function(t){var o=c.createCell({position:n({},t)});a.vectorAxis(function(e){return i.equal(o.position[e],t[e],e)})}),o.test("The game will execute a cell step",[[a.vector(0),a.vector(1),a.vector(1)],[a.vector(0),a.vector(2),a.vector(2)],[a.vector(4),a.vector(1),a.vector(5)],[a.vector(4),a.vector(2),a.vector(6)]],function(e,t,o){var r=c.createCell({position:n({},e),velocity:n({},t)});l.createTestLulas({cells:[r],behaviors:[s.move]}).step(),a.vectorAxis(function(e){return i.equal(r.position[e],o[e])})})}).call(this,"user-stories","user-stories/2 - As a user I want to watch them move.test.ts")},function(e,a,l){"use strict";(function(e,t){Object.defineProperty(a,"__esModule",{value:!0});var o=l(3),r=l(26),n=l(0),i=l(1),s=l(2),c=l(5);s.setFilename(e,t),s.test("A cell in (0,0) will have position adjusted to fit the screen",function(){var t=n.createCell({radius:5});c.createTestLulas({behaviors:[r.bounceOnCorners],cells:[t]}).step(),i.vectorAxis(function(e){return o.equal(t.position[e],5,e)})}),s.test("A cell in (0,0) will have velocity adjusted to bounce on screen",function(){var t=n.createCell({velocity:i.vector(-1)});c.createTestLulas({behaviors:[r.bounceOnCorners],cells:[t]}).step(),i.vectorAxis(function(e){return o.equal(t.velocity[e],1,e)})}),s.test("A cell outside of the window will have position adjusted to fit the screen",function(){var t=n.createCell({position:i.vector(200),radius:5});c.createTestLulas({behaviors:[r.bounceOnCorners],cells:[t],worldSize:i.vector(200)}).step(),i.vectorAxis(function(e){return o.equal(t.position[e],195,e)})}),s.test("A cell outside of the window will have velocity adjusted to bounce on screen",function(){var t=n.createCell({position:i.vector(200),velocity:i.vector(1)});c.createTestLulas({behaviors:[r.bounceOnCorners],cells:[t],worldSize:i.vector(200)}).step(),i.vectorAxis(function(e){return o.equal(t.velocity[e],-1,e)})})}).call(this,"user-stories","user-stories/3 - As a user I want them to bounce on the corners.test.ts")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bounceOnCorners=void 0,t.bounceOnCorners=function(e,t){var o=t.size;e.position.x-e.radius<0&&(e.position.x=e.radius,e.velocity.x=Math.abs(e.velocity.x)),e.position.y-e.radius<0&&(e.position.y=e.radius,e.velocity.y=Math.abs(e.velocity.y)),e.position.x+e.radius>o.x&&(e.position.x=o.x-e.radius,e.velocity.x=-Math.abs(e.velocity.x)),e.position.y+e.radius>o.y&&(e.position.y=o.y-e.radius,e.velocity.y=-Math.abs(e.velocity.y))}},function(e,l,u){"use strict";(function(e,t){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(l,"__esModule",{value:!0});var n=u(3),i=u(11),s=u(0),c=u(1),o=u(2),a=u(5);o.setFilename(e,t);o.test("A cell must navigate to the other side of the screen if they're pass the map limit",[[c.vector(0,201),c.vector(0,1)],[c.vector(201,0),c.vector(1,0)],[c.vector(201),c.vector(1)],[c.vector(0,-1),c.vector(0,199)],[c.vector(-1,0),c.vector(199,0)],[c.vector(-1),c.vector(199)]],function(e,t){var o=s.createCell({position:r({},e)});a.createTestLulas({behaviors:[i.roundMap],cells:[o],worldSize:c.vector(200)}).step(),c.vectorAxis(function(e){return n.equal(o.position[e],t[e])})})}).call(this,"user-stories","user-stories/3 - As a user I want them to navigate to the other side of the screen.test.ts")},function(e,i,s){"use strict";(function(e,t){var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0});var l=s(3),o=s(12),r=s(29),u=s(0),v=s(1),f=s(30),n=s(2),p=s(5);n.setFilename(e,t),[{name:"flocking.ts",alignementBehavior:o.alignementBehavior,cohesionBehavior:o.cohesionBehavior,separationBehavior:o.separationBehavior},{name:"flocking2.ts",alignementBehavior:r.alignementBehavior,cohesionBehavior:r.cohesionBehavior,separationBehavior:r.separationBehavior}].forEach(function(e){var t=e.name,s=e.alignementBehavior,r=e.cohesionBehavior,c=e.separationBehavior;n.test(t+" - A boid should align to it's neighbors",[[v.vector(0),v.vector(0,1)],[v.vector(1),v.vector(1,0)],[v.vector(0),v.vector(1)],[v.vector(0),v.vector(-1,0)],[v.vector(0),v.vector(0,-1)],[v.vector(0),v.vector(-1,-1)]],function(e,t){var o=p.createTestLulas({behaviors:[s],cells:[u.createCell({position:v.vector(10),acceleration:a({},e)}),u.createCell({position:v.vector(20),velocity:a({},t)})]}),r=v.getAngle(e),n=v.getAngle(t);o.step();var i=o.cells[0];l.ok(!v.isZero(i.acceleration)),f.assertBetweenOrEqual(v.getAngle(i.acceleration),r,n)}),n.test(t+" - A boid should get closer to nearby neighbors",[[v.vector(10)],[v.vector(-10)],[v.vector(15,-15)],[v.vector(-15,15)]],function(e){var t=p.createTestLulas({behaviors:[r],cells:[u.createCell({position:v.vector(0),acceleration:v.vector(0),vision:50}),u.createCell({position:a({},e),acceleration:v.vector(0)})]});t.step();var o=t.cells[0];l.ok(!v.isZero(o.acceleration)),f.assertBetweenOrEqual(v.getAngle(o.acceleration),0,v.getAngle(e))}),n.test(t+" - A boid should maintain distance from closer neighbors",[[v.vector(10)],[v.vector(10,5)],[v.vector(-10)],[v.vector(-5,-10)]],function(e){var t=v.vector(-100,100),o=p.createTestLulas({behaviors:[c],cells:[u.createCell({position:t,acceleration:v.vector(0),vision:50}),u.createCell({position:v.sumVectors(t,e)})]});o.step();var r=o.cells[0],n=v.getAngle(r.acceleration),i=v.getAngle(e)+180;180<i&&(i-=360),l.notEqual(n,0),f.assertBetweenOrEqual(n,0,i)})})}).call(this,"user-stories","user-stories/4 - As a user I want to watch them follow flocking behaviour.test.ts")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.separationBehavior=t.cohesionBehavior=t.alignementBehavior=t.flocking=void 0;var u=o(0),v=o(4),f=o(1);function r(e,t){var o=t.reduce(function(e,t){return f.sumVectors(e,t.velocity)},f.vector(0)),r=f.multiplyVectors(o,1/t.length),n=f.normalize(r),i=f.subtractVectors(n,e.velocity);return f.multiplyVectors(i,v.FLOCKING_ALIGMENENT_FACTOR)}function n(e,t){var o=t.reduce(function(e,t){return f.sumVectors(e,t.position)},f.vector(0)),r=f.multiplyVectors(o,1/t.length),n=f.subtractVectors(r,e.position),i=f.subtractVectors(n,e.velocity);return f.multiplyVectors(i,v.FLOCKING_COHESION_FACTOR)}function i(c,e){var a=c.vision*v.FLOCKING_SEPARATION_VISION_LIMIT,l=0,t=e.reduce(function(e,t){var o=u.cellDistance(c,t),r=o-c.radius-t.radius;if(a<o)return e;l++;var n=f.subtractVectors(c.position,t.position),i=Math.max(r,v.FLOCKING_SEPARATION_BORDER_LIMIT),s=f.multiplyVectors(n,1/i);return f.sumVectors(e,s)},f.vector(0));if(0===l)return f.vector(0);var o=f.multiplyVectors(t,1/l),r=f.subtractVectors(o,c.velocity);return f.multiplyVectors(r,v.FLOCKING_SEPARATION_FACTOR)}function s(n){return function(e,t){var o=(0,t.look)(e.vision);if(o.length){var r=n(e,o);u.applyForce(e,f.normalize(r,v.MAX_FORCE))}}}t.flocking=s(function(e,t){return f.sumVectorList([r(e,t),n(e,t),i(e,t)])}),t.alignementBehavior=s(r),t.cohesionBehavior=s(n),t.separationBehavior=s(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertBetweenOrEqual=t.assertBetween=void 0;var c=o(3);t.assertBetween=function(e,t,o,r){void 0===r&&(r="");var n=Math.min(t,o),i=Math.max(t,o),s="Expected "+e+" to be between "+n+" and "+i+" ("+r+")";n!==i?(c(n<e,s),c(e<i,s)):c(e===n,s)},t.assertBetweenOrEqual=function(e,t,o,r){void 0===r&&(r="");var n=Math.min(t,o),i=Math.max(t,o),s="Expected "+e+" to be between "+n+" and "+i+" ("+r+")";n!==i?(c(n<=e,s),c(e<=i,s)):c(e===n,s)}},function(e,r,n){"use strict";(function(e,t){var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});var s=n(3),c=n(13),a=n(0),l=n(1),o=n(2),u=n(5);o.setFilename(e,t),o.test("Cells should immediately separate each other if they overlap",[[l.vector(1,0),l.vector(-1,0),l.vector(5,0)],[l.vector(0,1),l.vector(0,-1),l.vector(0,5)],[l.vector(1),l.vector(-1),l.vector(3.5355339059327378)]],function(e,t,o){var r=u.createTestLulas({behaviors:[c.solidBody],cells:[a.createCell({position:i({},e),velocity:l.vector(0)}),a.createCell({position:i({},t),velocity:l.vector(0)})]});r.step();var n=r.cells[0];l.vectorAxis(function(e){return s.equal(n.position[e],o[e])})}),o.test("Cells should stop if they collide on each other",function(){var e=u.createTestLulas({behaviors:[c.solidBody],cells:[a.createCell({position:l.vector(1),velocity:l.vector(-1)}),a.createCell({position:l.vector(-1),velocity:l.vector(0)})]});e.step();var t=e.cells[0];l.vectorAxis(function(e){return s(0<=t.velocity[e])})})}).call(this,"user-stories","user-stories/5 - As a user I want to watch the cell not overlap.test.ts")}]);
//# sourceMappingURL=main.js.map