{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/cell.ts","webpack:///./src/vector.ts","webpack:///./test/index.ts","webpack:///./test/test-duplicates.ts","webpack:///./src/CONFIGURATION.ts","webpack:///./src/math.ts","webpack:///./src/behaviors/move.ts","webpack:///./src/color.ts","webpack:///./src/lulas.ts","webpack:///./src/behaviors/roundMap.ts","webpack:///./src/behaviors/flocking.ts","webpack:///./src/behaviors/solidBody.ts","webpack:///./src/index.ts","webpack:///./test/user-stories.ts","webpack:///./user-stories sync \\.ts$","webpack:///./user-stories/0 - As a developer I want to run tests.test.ts","webpack:///./user-stories/1 - As a user I want to see cells.test.ts","webpack:///./user-stories/2 - As a user I want to watch them move.test.ts","webpack:///./user-stories/3 - As a user I want them to bounce on the corners.test.ts","webpack:///./src/behaviors/bounceOnCorners.ts","webpack:///./user-stories/3 - As a user I want them to navigate to the other side of the screen.test.ts","webpack:///./user-stories/4 - As a user I want to watch them follow flocking behaviour.test.ts","webpack:///./test/assertions.ts","webpack:///./user-stories/5 - As a user I want to watch the cell not overlap.test.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","vector_1","CONFIGURATION_1","color_1","ANGLE_CORRECTION","Math","PI","lastId","renderAt","context","cell","pos","position","save","translate","x","y","rotate","radians","velocity","beginPath","arc","radius","lineTo","closePath","lineWidth","strokeStyle","color","fillStyle","bajarColor","stroke","fill","restore","createCell","partial","__assign","id","vector","acceleration","DEFAULT_RADIUS","vision","DEFAULT_VISION_FACTOR","cellDistance","left","right","magnitude","subtractVectors","renderCell","_a","size","renderRadius","logCell","logVector","isZero","sqrt","pow","normalize","point","targetMagnitude","mag","vectorAxis","axis","atan2","operate","getAngle","limitVector","limit","sumVectors","sumVectorList","vectors","map","v","reduce","a","b","multiplyVectors","tests","documentTitle","document","title","file","executeTest","message","table","run","isJestTesting","console","groupCollapsed","runTest","groupEnd","global","test","log","error","write","stack","replace","printError","setFailState","body","style","backgroundColor","Boolean","first","second","Array","isArray","unit","runTests","background","lastFile","_i","tests_1","setSuccessState","setFilename","dirname","filename","lulas_1","cell_1","createTestLulas","config","default","canvas","createElement","cells","worldSize","behaviors","MAX_SPEED","MAX_FORCE","COLLISION_FRICTION","FLOCKING_ALIGMENENT_FACTOR","FLOCKING_COHESION_FACTOR","FLOCKING_SEPARATION_FACTOR","FLOCKING_SEPARATION_VISION_LIMIT","FLOCKING_SEPARATION_BORDER_LIMIT","getSign","abs","random","min","max","round","move","math_1","toString","g","alpha","toHex","val","randomColor","percent","rgba","match","Error","parseInt","toRGBA","lulas","_b","width","height","currentCell","world","look","target","filter","getContext","renderCellToContext","step","forEach","render","clearRect","roundMap","alignement","neighbors","sum","average","relative","align","cohesion","cohece","separation","requireNeighbors","fn","flocking","alignementBehavior","cohesionBehavior","separationBehavior","collide","correction","adjustment","factor","vel","collisionBrake_bounce","solidBody","collision","other","minDistance","distance","index_1","flocking_1","move_1","solidBody_1","roundMap_1","__awaiter","fullscreen","margin","padding","documentElement","el","assign","setStyles","sent","appendChild","innerWidth","innerHeight","center","game","operator","_","array","join","requestAnimationFrame","frame","start","setTimeout","keys","./0 - As a developer I want to run tests.test.ts","./1 - As a user I want to see cells.test.ts","./2 - As a user I want to watch them move.test.ts","./3 - As a user I want them to bounce on the corners.test.ts","./3 - As a user I want them to navigate to the other side of the screen.test.ts","./4 - As a user I want to watch them follow flocking behaviour.test.ts","./5 - As a user I want to watch the cell not overlap.test.ts","webpackContext","req","webpackContextResolve","e","code","resolve","isTestRunning","__dirname","__filename","assert","test_duplicates_1","isCanvasBlank_browser","getImageData","some","channel","isCanvasBlank_mock","__getEvents","every","type","isCanvasBlank","assert_1","equal","exp","bounceOnCorners_1","bounceOnCorners","SIZE","assertions_1","assert_2","targetVel","neighborVel","angleBefore","neighborAngle","sut","angleAfter","notEqual","assertBetweenOrEqual","cellPosition","separationAngle","assertBetween","finalMessage","pos1","pos2","expected"],"mappings":"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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([14,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { World } from './lulas';\nimport {\n  Vector,\n  vector,\n  logVector,\n  magnitude,\n  subtractVectors,\n  radians,\n} from './vector';\nimport { DEFAULT_VISION_FACTOR, DEFAULT_RADIUS } from './CONFIGURATION';\nimport { bajarColor, Color } from './color';\n\nconst ANGLE_CORRECTION = Math.PI / 4;\n\nexport type CellId = '[number CellId]';\nlet lastId = 0;\n\nfunction getNextId() {\n  return (lastId++ as any) as CellId;\n}\n\nexport interface Cell {\n  id: CellId;\n  color: Color;\n  position: Vector;\n  velocity: Vector;\n  acceleration: Vector;\n  radius: number;\n  vision: number;\n}\n\nexport function createCell(partial?: Partial<Cell>): Cell {\n  return {\n    id: getNextId(),\n    color: '#ffffff' as Color,\n    position: vector(0),\n    velocity: vector(0),\n    acceleration: vector(0),\n    radius: DEFAULT_RADIUS,\n    vision:\n      (partial && partial.radius ? partial.radius : DEFAULT_RADIUS) *\n      DEFAULT_VISION_FACTOR,\n    ...partial,\n  };\n}\n\nexport function cellDistance(left: Cell, right: Cell) {\n  return magnitude(subtractVectors(left.position, right.position));\n}\n\nexport function renderCell(\n  context: CanvasRenderingContext2D,\n  { size }: World,\n  cell: Cell,\n) {\n  const renderRadius = cell.radius + 10;\n  const { position: pos } = cell;\n\n  renderAt(context, cell);\n\n  if (pos.x - renderRadius < 0) {\n    renderAt(context, cell, { x: pos.x + size.x, y: pos.y });\n  }\n  if (pos.x + renderRadius > size.x) {\n    renderAt(context, cell, { x: pos.x - size.x, y: pos.y });\n  }\n\n  if (pos.y - renderRadius < 0) {\n    renderAt(context, cell, { x: pos.x, y: pos.y + size.y });\n  }\n  if (pos.y + renderRadius > size.y) {\n    renderAt(context, cell, { x: pos.x, y: pos.y - size.y });\n  }\n}\n\nfunction renderAt(\n  context: CanvasRenderingContext2D,\n  cell: Cell,\n  pos = cell.position,\n) {\n  context.save();\n  context.translate(pos.x, pos.y);\n\n  context.rotate(radians(cell.velocity) + ANGLE_CORRECTION);\n  context.beginPath();\n  context.arc(0, 0, cell.radius, 0, Math.PI * 1.5);\n  context.lineTo(cell.radius, -cell.radius);\n  // context.lineTo(cell.radius, 0);\n  context.closePath();\n  context.lineWidth = 5;\n  context.strokeStyle = cell.color;\n  context.fillStyle = bajarColor(cell.color, 0.5);\n  context.stroke();\n  context.fill();\n\n  context.restore();\n}\n\nexport function logCell(cell: Cell) {\n  return `Cell(${cell.id}) ${cell.radius} { pos: ${logVector(\n    cell.position,\n  )}, vel: ${logVector(cell.velocity)} }`;\n}\n","export interface Vector {\n  x: number;\n  y: number;\n}\n\nexport function vector(x: number, y = x): Vector {\n  return { x, y };\n}\n\nexport function isZero({ x, y }: Vector) {\n  return x === 0 && y === 0;\n}\n\nexport function magnitude({ x, y }: Vector) {\n  return Math.sqrt(x ** 2 + y ** 2);\n}\n\nexport function normalize(point: Vector, targetMagnitude = 1) {\n  if (isZero(point)) {\n    return { ...point };\n  }\n\n  const mag = magnitude(point);\n  return vectorAxis((axis) => (point[axis] * targetMagnitude) / mag);\n}\n\nexport function radians({ x, y }: Vector) {\n  return Math.atan2(y, x);\n}\n\nexport function getAngle(vector: Vector) {\n  return (radians(vector) * 180) / Math.PI;\n}\n\nexport function limitVector(point: Vector, limit: number) {\n  const mag = magnitude(point);\n  return mag > limit ? normalize(point, limit) : point;\n}\n\nexport function sumVectors(left: Vector, right: Vector): Vector {\n  return vectorAxis((axis) => left[axis] + right[axis]);\n}\n\nexport function sumVectorList(vectors: Vector[]): Vector {\n  return vectorAxis((axis) =>\n    vectors.map((v) => v[axis]).reduce((a, b) => a + b),\n  );\n}\n\nexport function subtractVectors(left: Vector, right: Vector) {\n  return vectorAxis((axis) => left[axis] - right[axis]);\n}\n\nexport function multiplyVectors(point: Vector, value: number) {\n  return vectorAxis((axis) => point[axis] * value);\n}\n\nexport function vectorAxis(operate: (key: 'x' | 'y') => number): Vector;\nexport function vectorAxis(operate: (key: 'x' | 'y') => void): void;\nexport function vectorAxis(\n  operate: (key: 'x' | 'y') => number | void,\n): Vector | void {\n  const x = operate('x');\n  const y = operate('y');\n\n  if (typeof x === 'number' && typeof y === 'number') {\n    return { x, y };\n  }\n}\n\nexport function logVector(point: Vector) {\n  return `(${point.x},${point.y})`;\n}\n","type TestRun<T extends any[]> = (...args: T) => Promise<any> | void;\n\ninterface UnitTest_Basic {\n  file: string;\n  message: string;\n  table: null;\n  run: TestRun<[]>;\n}\n\ninterface UnitTest_Table<T extends any[] = []> {\n  file: string;\n  message: string;\n  table: T[];\n  run: TestRun<T>;\n}\n\ntype UnitTest<T extends any[]> = UnitTest_Basic | UnitTest_Table<T>;\n\n// -----\n\nconst tests: UnitTest<any>[] = [];\nconst documentTitle = document.title;\nlet file = '';\n\nexport const isJestTesting = Boolean(\n  typeof global !== 'undefined' && (global as any).test,\n);\n\nexport function test(message: string, run: TestRun<[]>): void;\nexport function test<T extends any[]>(\n  message: string,\n  table: T[],\n  run: TestRun<T>,\n): void;\n\nexport function test<T extends any[]>(\n  message: string,\n  first: TestRun<[]> | T[],\n  second?: TestRun<T>,\n): void {\n  const table = Array.isArray(first) ? first : null;\n  const run = table ? second : (first as TestRun<T>);\n  const unit = { file, message, table, run } as UnitTest<T>;\n\n  if (isJestTesting) {\n    executeTest(unit);\n  } else {\n    tests.push(unit);\n  }\n}\n\nexport function runTests({ background }: { background?: string } = {}) {\n  setInitialState();\n  let lastFile = '';\n\n  for (const unit of tests) {\n    if (!isJestTesting && unit.file !== lastFile) {\n      console.groupEnd();\n      lastFile = unit.file;\n      console.groupCollapsed(unit.file);\n    }\n\n    executeTest(unit);\n  }\n\n  if (!isJestTesting) {\n    console.groupEnd();\n  }\n\n  tests.length = 0;\n  document.title = documentTitle;\n  setSuccessState(background);\n}\n\nexport function setFilename(dirname: string, filename: string) {\n  file = filename.replace(`${dirname}/`, '').replace(/(\\.test)?\\.ts$/, '');\n}\n\nfunction executeTest<T extends any[]>({\n  file,\n  message,\n  table,\n  run,\n}: UnitTest<T>) {\n  if (!table) {\n    runTest(file, message, run as TestRun<[]>);\n    return;\n  }\n\n  if (!isJestTesting) {\n    console.groupCollapsed(message);\n  }\n\n  for (let i = 0; i < table.length; i++) {\n    runTest(file, `${message} [${i}]`, () => run(...table[i]));\n  }\n\n  if (!isJestTesting) {\n    console.groupEnd();\n  }\n}\n\nfunction runTest(file: string, message: string, run: TestRun<[]>) {\n  if (isJestTesting) {\n    (global as any).test(message, run);\n    return;\n  }\n\n  try {\n    run();\n    console.log(`${message} ðŸŸ¢`);\n  } catch (error) {\n    printError(file, error, message);\n    setFailState();\n    throw error;\n  }\n}\n\nfunction printError(file: string, error: Error, message: string) {\n  console.log(`${message} ðŸ”´`);\n  console.error(error);\n  document.write(`\n    <div style=\"display: flex; align-items:center; justify-content: center; height: 100%\">\n    <span>\n      <h1>${file}</h1>\n      <h2>${message}</h2>\n      <pre>${error.stack?.replace('\\n', '<br>')}}</pre>\n    </span>\n    </div>\n  `);\n}\n\n// -----\n\nfunction setInitialState() {\n  setFailState();\n}\n\nfunction setFailState() {\n  document.body.style.backgroundColor = '#440000';\n}\n\nfunction setSuccessState(background = 'green') {\n  document.body.style.backgroundColor = background;\n}\n","import lulas, { LulasConfig } from '../src/lulas';\nimport { createCell } from '../src/cell';\n\nexport function createTestLulas(config: Partial<LulasConfig> = {}) {\n  return lulas({\n    canvas: document.createElement('canvas'),\n    cells: [createCell()],\n    worldSize: { x: 1000, y: 1000 },\n    behaviors: [],\n    ...config,\n  });\n}\n","export const DEFAULT_RADIUS = 5;\nexport const MAX_SPEED = 2;\nexport const MAX_FORCE = 0.5;\n\n// Multiplier for cell's radius\nexport const DEFAULT_VISION_FACTOR = 10;\n\n// Friction when two cells collide\nexport const COLLISION_FRICTION = 0.5;\n\nexport const FLOCKING_ALIGMENENT_FACTOR = 0.05;\nexport const FLOCKING_COHESION_FACTOR = 0.001;\nexport const FLOCKING_SEPARATION_FACTOR = 0.005;\n\n// Multiplier over cell's vision\nexport const FLOCKING_SEPARATION_VISION_LIMIT = 0.5;\n// From this point separation becomes stronger\nexport const FLOCKING_SEPARATION_BORDER_LIMIT = 0.1;\n","export function getSign(value: number) {\n  if (value === 0) {\n    return 0;\n  }\n\n  return value / Math.abs(value);\n}\n\nexport function random(first: number, second = -first) {\n  const min = Math.min(first, second);\n  const max = Math.max(first, second);\n  return Math.round(Math.random() * (max - min) + min);\n}\n","import { MAX_SPEED, MAX_FORCE } from './../CONFIGURATION';\nimport { Cell } from '../cell';\nimport { sumVectors, limitVector, vector } from '../vector';\n\nexport function move(cell: Cell) {\n  cell.velocity = sumVectors(\n    cell.velocity,\n    limitVector(cell.acceleration, MAX_FORCE),\n  );\n\n  // limitVector(a, MAX_SPEED);\n\n  cell.acceleration = vector(0);\n\n  cell.position.x += cell.velocity.x;\n  cell.position.y += cell.velocity.y;\n}\n","import { random } from './math';\n\nexport type Color = '[string Color]';\n\nexport function randomColor() {\n  return toString({\n    r: random(100, 200),\n    g: random(100, 200),\n    b: random(100, 200),\n    a: 1,\n  });\n}\n\nexport function bajarColor(color: Color, percent: number) {\n  const rgba = toRGBA(color);\n  rgba.r *= percent;\n  rgba.g *= percent;\n  rgba.b *= percent;\n  // rgba.a *= percent;\n  return toString(rgba);\n}\n\nfunction toRGBA(color: Color): RGBA {\n  const match = color.match(/#(\\w{2})(\\w{2})(\\w{2})(\\w{2})?/);\n\n  if (!match) {\n    throw new Error(`DAFUK COLOR IS DIS? ${color}`);\n  }\n\n  const [_, r, g, b, a] = match;\n\n  return {\n    r: parseInt(r, 16),\n    g: parseInt(g, 16),\n    b: parseInt(b, 16),\n    a: a ? parseInt(a, 16) / 255 : 1,\n  };\n}\n\nfunction toString({ r, g, b, a: alpha }: RGBA): Color {\n  const a = toHex(Math.round(alpha * 255));\n  return `#${toHex(r)}${toHex(g)}${toHex(b)}${a}` as Color;\n}\n\nfunction toHex(val: number) {\n  const result = Math.round(val).toString(16);\n  return result.length === 1 ? `0${result}` : result;\n}\n\ninterface RGBA {\n  r: number;\n  g: number;\n  b: number;\n  a: number;\n}\n","import { Vector } from './vector';\nimport { Cell, cellDistance, renderCell } from './cell';\n\nexport interface World {\n  size: Vector;\n  look: (radius: number) => Cell[];\n}\n\nexport type Behavior = (cell: Cell, world: World) => void;\n\nexport interface LulasConfig {\n  canvas: HTMLCanvasElement;\n  cells: Cell[];\n  behaviors: Behavior[];\n  worldSize?: Vector;\n}\n\nexport function lulas({\n  canvas,\n  cells,\n  behaviors,\n  worldSize = { x: canvas.width, y: canvas.height },\n}: LulasConfig) {\n  let currentCell: Cell | null = null;\n  const world = {\n    size: worldSize,\n    look(radius: number) {\n      return look(currentCell!, radius);\n    },\n  };\n\n  const context = canvas.getContext('2d')!;\n  const renderCellToContext = renderCell.bind(null, context, world);\n\n  return {\n    get cells() {\n      return cells;\n    },\n    step() {\n      cells = cells.map((x) => {\n        const cell = { ...x };\n        currentCell = x;\n        behaviors.forEach((b) => b(cell, world));\n        return cell;\n      });\n    },\n    render() {\n      context.strokeStyle = 'blue';\n      context.fillStyle = 'blue';\n      context.clearRect(0, 0, canvas.width, canvas.height);\n      cells.forEach(renderCellToContext);\n    },\n  };\n\n  function look(target: Cell, radius: number): Cell[] {\n    return cells.filter(\n      (x) => x !== target && cellDistance(target, x) < radius,\n    );\n  }\n}\n\nexport default lulas;\n","import { World } from './../lulas';\nimport { Cell } from '../cell';\n\nexport function roundMap(cell: Cell, { size }: World) {\n  if (cell.position.x < 0) {\n    cell.position.x += size.x;\n  }\n\n  if (cell.position.y < 0) {\n    cell.position.y += size.y;\n  }\n\n  if (cell.position.x > size.x) {\n    cell.position.x -= size.x;\n  }\n\n  if (cell.position.y > size.y) {\n    cell.position.y -= size.y;\n  }\n}\n","import { World, Behavior } from './../lulas';\nimport { Cell, cellDistance } from '../cell';\nimport {\n  sumVectors,\n  vector,\n  multiplyVectors,\n  subtractVectors,\n} from '../vector';\nimport {\n  FLOCKING_ALIGMENENT_FACTOR,\n  FLOCKING_COHESION_FACTOR,\n  FLOCKING_SEPARATION_FACTOR,\n  FLOCKING_SEPARATION_VISION_LIMIT,\n} from '../CONFIGURATION';\n\nexport const flocking = requireNeighbors(flockingCore);\nexport const alignementBehavior = requireNeighbors(alignement);\nexport const cohesionBehavior = requireNeighbors(cohesion);\nexport const separationBehavior = requireNeighbors(separation);\n\nfunction flockingCore(cell: Cell, neighbors: Cell[]) {\n  if (!neighbors.length) {\n    return;\n  }\n\n  alignement(cell, neighbors);\n  cohesion(cell, neighbors);\n  separation(cell, neighbors);\n}\n\nfunction alignement(cell: Cell, neighbors: Cell[]) {\n  if (!neighbors.length) {\n    return;\n  }\n\n  const sum = neighbors.map((x) => x.velocity).reduce(sumVectors, vector(0));\n  const average = multiplyVectors(sum, 1 / neighbors.length);\n  const relative = subtractVectors(average, cell.velocity);\n  const align = multiplyVectors(relative, FLOCKING_ALIGMENENT_FACTOR);\n\n  cell.velocity.x += align.x;\n  cell.velocity.y += align.y;\n}\n\nfunction cohesion(cell: Cell, neighbors: Cell[]) {\n  if (!neighbors.length) {\n    return;\n  }\n\n  const sum = neighbors.map((x) => x.position).reduce(sumVectors, vector(0));\n  const average = multiplyVectors(sum, 1 / neighbors.length);\n  const relative = subtractVectors(average, cell.position);\n  const cohece = multiplyVectors(relative, FLOCKING_COHESION_FACTOR);\n\n  cell.velocity.x += cohece.x;\n  cell.velocity.y += cohece.y;\n}\n\nfunction separation(cell: Cell, neighbors: Cell[]) {\n  const limit = cell.vision * FLOCKING_SEPARATION_VISION_LIMIT;\n  neighbors = neighbors.filter((x) => cellDistance(cell, x) < limit);\n\n  if (!neighbors.length) {\n    return;\n  }\n\n  const sum = neighbors.map((x) => x.position).reduce(sumVectors, vector(0));\n  const average = multiplyVectors(sum, 1 / neighbors.length);\n  const relative = subtractVectors(average, cell.position);\n  const separation = multiplyVectors(relative, FLOCKING_SEPARATION_FACTOR);\n\n  cell.velocity.x -= separation.x;\n  cell.velocity.y -= separation.y;\n}\n\nfunction requireNeighbors(\n  fn: (cell: Cell, neighbors: Cell[]) => void,\n): Behavior {\n  return (cell: Cell, { look }: World) => fn(cell, look(cell.vision));\n}\n","import { Cell, cellDistance } from '../cell';\nimport { World } from '../lulas';\nimport { getSign } from '../math';\nimport { normalize, Vector, multiplyVectors } from '../vector';\nimport { COLLISION_FRICTION } from '../CONFIGURATION';\n\nexport function solidBody(cell: Cell, { look }: World) {\n  const collision = look(cell.radius * 2);\n\n  for (let i = 0; i < collision.length; i++) {\n    const other = collision[i];\n    const minDistance = other.radius + cell.radius;\n    const distance = cellDistance(other, cell);\n\n    if (distance < minDistance) {\n      collide(cell, other, (minDistance - distance) / 2);\n    }\n  }\n}\n\nfunction collide(a: Cell, b: Cell, correction: number) {\n  const adjustment = normalize(\n    {\n      x: a.position.x - b.position.x,\n      y: a.position.y - b.position.y,\n    },\n    correction,\n  );\n\n  a.position.x += adjustment.x;\n  a.position.y += adjustment.y;\n  b.position.x -= adjustment.x;\n  b.position.y -= adjustment.y;\n\n  collisionBrake_bounce(a, b, adjustment);\n}\n\nfunction collisionBrake_bounce(a: Cell, b: Cell, adjustment: Vector) {\n  const factor = 1 - COLLISION_FRICTION;\n  const vel = a.velocity;\n  a.velocity = multiplyVectors(b.velocity, factor);\n  b.velocity = multiplyVectors(vel, factor);\n}\n\nfunction collisionBrake_reflect(a: Cell, b: Cell, adjustment: Vector) {\n  const signX = getSign(adjustment.x);\n  const signY = getSign(adjustment.y);\n\n  if (getSign(a.velocity.x) === -signX) {\n    a.velocity.x = -a.velocity.x * (1 - COLLISION_FRICTION);\n  }\n\n  if (getSign(a.velocity.y) === -signY) {\n    a.velocity.y = -a.velocity.y * (1 - COLLISION_FRICTION);\n  }\n\n  if (getSign(b.velocity.x) === signX) {\n    b.velocity.x = -b.velocity.x * (1 - COLLISION_FRICTION);\n  }\n\n  if (getSign(b.velocity.y) === signY) {\n    b.velocity.y = -b.velocity.y * (1 - COLLISION_FRICTION);\n  }\n}\n","import '../test/user-stories';\nimport { runTests } from '../test/index';\nimport lulas from './lulas';\nimport { createCell, logCell } from './cell';\nimport { vector } from './vector';\nimport { flocking } from './behaviors/flocking';\nimport { move } from './behaviors/move';\nimport { bounceOnCorners } from './behaviors/bounceOnCorners';\nimport { solidBody } from './behaviors/solidBody';\nimport { random } from './math';\nimport { randomColor } from './color';\nimport { roundMap } from './behaviors/roundMap';\n\n(async () => {\n  setStyles();\n  await runTests({\n    background: 'black',\n  });\n  start();\n})();\n\nsetTimeout(() => {\n  document.body.style.backgroundColor = 'black';\n});\n\nfunction start() {\n  const canvas = document.createElement('canvas');\n  document.body.appendChild(canvas);\n  canvas.width = window.innerWidth;\n  canvas.height = window.innerHeight;\n\n  const center = vector(canvas.width / 2, canvas.height / 2);\n  const createRandomCell = (i: number) =>\n    createCell({\n      position: { ...center },\n      velocity: vector(random(10), random(10)),\n      radius: random(5, 20),\n      color: randomColor(),\n    });\n\n  const game = lulas({\n    canvas,\n    cells: array(50, createRandomCell),\n    behaviors: [flocking, move, solidBody, roundMap],\n  });\n\n  console.log('Initial state');\n  logState();\n\n  game.render();\n  requestAnimationFrame(function frame() {\n    game.step();\n    game.render();\n    requestAnimationFrame(frame);\n  });\n\n  function logState() {\n    console.log(game.cells.map(logCell).join('\\n'));\n  }\n}\n\nfunction array<T>(size: number, operator: (pos: number) => T): T[] {\n  return Array(size)\n    .fill(null)\n    .map((_, i) => i + 1)\n    .map(operator);\n}\n\nfunction setStyles() {\n  const fullscreen = {\n    margin: 0,\n    padding: 0,\n    height: '100%',\n  };\n\n  for (const el of [document.documentElement, document.body]) {\n    Object.assign(el.style, fullscreen);\n  }\n}\n","requireAll((require as any).context('../user-stories/', true, /\\.ts$/));\n\nfunction requireAll(r: any) {\n  r.keys().forEach(r);\n}\n","var map = {\n\t\"./0 - As a developer I want to run tests.test.ts\": 17,\n\t\"./1 - As a user I want to see cells.test.ts\": 18,\n\t\"./2 - As a user I want to watch them move.test.ts\": 24,\n\t\"./3 - As a user I want them to bounce on the corners.test.ts\": 25,\n\t\"./3 - As a user I want them to navigate to the other side of the screen.test.ts\": 27,\n\t\"./4 - As a user I want to watch them follow flocking behaviour.test.ts\": 28,\n\t\"./5 - As a user I want to watch the cell not overlap.test.ts\": 30\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 16;","import { isJestTesting, test, setFilename } from '../test/index';\n\nlet isTestRunning = false;\n\nsetFilename(__dirname, __filename);\n\ntest('Should render something', () => {\n  isTestRunning = true;\n\n  if (!isJestTesting) {\n    console.log('Tests running...');\n  }\n});\n\nsetTimeout(testTester, 0);\n\nfunction testTester() {\n  if (!isTestRunning) {\n    document.body.style.backgroundColor = 'yellow';\n    throw new Error('Test suite not runnig');\n  }\n}\n","import * as assert from 'assert';\n\nimport { CanvasRenderingContext2DEvent } from '../node_modules/jest-canvas-mock/types/index.d';\nimport { createCell } from '../src/cell';\nimport { isJestTesting, setFilename, test } from '../test/index';\nimport { createTestLulas } from '../test/test-duplicates';\n\nsetFilename(__dirname, __filename);\n\ntest('Should render something', () => {\n  const canvas = document.createElement('canvas');\n  const lulas = createTestLulas({ canvas });\n  const isCanvasBlank = isJestTesting\n    ? isCanvasBlank_mock\n    : isCanvasBlank_browser;\n\n  lulas.render();\n  assert(!isCanvasBlank(canvas));\n});\n\ntest('Cells should be instanciable', () => {\n  const cell = createCell();\n  assert(cell);\n});\n\nfunction isCanvasBlank_browser(canvas: HTMLCanvasElement) {\n  return !canvas\n    .getContext('2d')!\n    .getImageData(0, 0, canvas.width, canvas.height)\n    .data.some((channel) => channel !== 0);\n}\n\nfunction isCanvasBlank_mock(canvas: HTMLCanvasElement) {\n  const context = canvas.getContext('2d')!;\n  return (context as any).__getEvents().every(\n    (x: CanvasRenderingContext2DEvent) =>\n      x.type === 'fillStyle' ||\n      x.type === 'strokeStyle' ||\n      // ((console.log(x.type, /^(fill|stroke)/.test(x.type)) as any) || true) ||\n      !/^(fill|stroke)/.test(x.type),\n  );\n}\n","import { equal as assertEqual } from 'assert';\n\nimport { createCell } from '../src/cell';\nimport { test, setFilename } from '../test/index';\nimport { createTestLulas } from '../test/test-duplicates';\nimport { vector, vectorAxis } from '../src/vector';\nimport { move } from '../src/behaviors/move';\n\nsetFilename(__dirname, __filename);\n\ntest(\n  'I should be able to create a cell with predefined parameters',\n  [[vector(0)], [vector(1)], [vector(2)]],\n  (pos) => {\n    const cell = createCell({\n      position: { ...pos },\n    });\n\n    vectorAxis((axis) => assertEqual(cell.position[axis], pos[axis], axis));\n  },\n);\n\ntest(\n  'The game will execute a cell step',\n  [\n    [vector(0), vector(1), vector(1)],\n    [vector(0), vector(2), vector(2)],\n    [vector(4), vector(1), vector(5)],\n    [vector(4), vector(2), vector(6)],\n  ],\n  (pos, vel, exp) => {\n    const cell = createCell({\n      position: { ...pos },\n      velocity: { ...vel },\n    });\n    const sut = createTestLulas({\n      cells: [cell],\n      behaviors: [move],\n    });\n\n    sut.step();\n\n    vectorAxis((axis) => assertEqual(cell.position[axis], exp[axis]));\n  },\n);\n","import { equal } from 'assert';\n\nimport { createCell } from '../src/cell';\nimport { test, setFilename } from '../test/index';\nimport { createTestLulas } from '../test/test-duplicates';\nimport { vectorAxis, vector } from '../src/vector';\nimport { bounceOnCorners } from '../src/behaviors/bounceOnCorners';\n\nsetFilename(__dirname, __filename);\n\ntest('A cell in (0,0) will have position adjusted to fit the screen', () => {\n  const cell = createCell({ radius: 5 });\n  const sut = createTestLulas({\n    behaviors: [bounceOnCorners],\n    cells: [cell],\n  });\n\n  sut.step();\n\n  vectorAxis((axis) => equal(cell.position[axis], 5, axis));\n});\n\ntest('A cell in (0,0) will have velocity adjusted to bounce on screen', () => {\n  const cell = createCell({ velocity: vector(-1) });\n  const sut = createTestLulas({\n    behaviors: [bounceOnCorners],\n    cells: [cell],\n  });\n\n  sut.step();\n\n  vectorAxis((axis) => equal(cell.velocity[axis], 1, axis));\n});\n\ntest('A cell outside of the window will have position adjusted to fit the screen', () => {\n  const size = 200;\n  const cell = createCell({ position: vector(size), radius: 5 });\n  const sut = createTestLulas({\n    behaviors: [bounceOnCorners],\n    cells: [cell],\n    worldSize: vector(size),\n  });\n\n  sut.step();\n\n  vectorAxis((axis) => equal(cell.position[axis], 195, axis));\n});\n\ntest('A cell outside of the window will have velocity adjusted to bounce on screen', () => {\n  const size = 200;\n  const cell = createCell({\n    position: vector(size),\n    velocity: vector(1),\n  });\n  const sut = createTestLulas({\n    behaviors: [bounceOnCorners],\n    cells: [cell],\n    worldSize: vector(size),\n  });\n\n  sut.step();\n\n  vectorAxis((axis) => equal(cell.velocity[axis], -1, axis));\n});\n","import { World } from './../lulas';\nimport { Cell } from '../cell';\n\nexport function bounceOnCorners(cell: Cell, { size }: World) {\n  if (cell.position.x - cell.radius < 0) {\n    cell.position.x = cell.radius;\n    cell.velocity.x = Math.abs(cell.velocity.x);\n  }\n\n  if (cell.position.y - cell.radius < 0) {\n    cell.position.y = cell.radius;\n    cell.velocity.y = Math.abs(cell.velocity.y);\n  }\n\n  if (cell.position.x + cell.radius > size.x) {\n    cell.position.x = size.x - cell.radius;\n    cell.velocity.x = -Math.abs(cell.velocity.x);\n  }\n\n  if (cell.position.y + cell.radius > size.y) {\n    cell.position.y = size.y - cell.radius;\n    cell.velocity.y = -Math.abs(cell.velocity.y);\n  }\n}\n","import { test, setFilename } from '../test/index';\nimport { vector, vectorAxis } from '../src/vector';\nimport { createCell } from '../src/cell';\nimport { createTestLulas } from '../test/test-duplicates';\nimport { equal } from 'assert';\nimport { roundMap } from '../src/behaviors/roundMap';\n\nsetFilename(__dirname, __filename);\n\nconst SIZE = 200;\n\ntest(\n  \"A cell must navigate to the other side of the screen if they're pass the map limit\",\n  [\n    [vector(0, SIZE + 1), vector(0, 1)],\n    [vector(SIZE + 1, 0), vector(1, 0)],\n    [vector(SIZE + 1), vector(1)],\n    [vector(0, -1), vector(0, SIZE - 1)],\n    [vector(-1, 0), vector(SIZE - 1, 0)],\n    [vector(-1), vector(SIZE - 1)],\n  ],\n  (pos, exp) => {\n    const cell = createCell({ position: { ...pos } });\n    const sut = createTestLulas({\n      behaviors: [roundMap],\n      cells: [cell],\n      worldSize: vector(SIZE),\n    });\n\n    sut.step();\n\n    vectorAxis((axis) => equal(cell.position[axis], exp[axis]));\n  },\n);\n","import {\n  alignementBehavior,\n  cohesionBehavior,\n  separationBehavior,\n} from './../src/behaviors/flocking';\n\nimport { notEqual, ok } from 'assert';\n\nimport { createCell } from '../src/cell';\nimport {\n  vector,\n  vectorAxis,\n  Vector,\n  getAngle,\n  sumVectors,\n} from '../src/vector';\nimport { test, setFilename } from '../test/index';\nimport { createTestLulas } from '../test/test-duplicates';\nimport { assertBetween, assertBetweenOrEqual } from '../test/assertions';\nimport { equal } from 'assert';\nimport { move } from '../src/behaviors/move';\n\n// GLOSSARY: Boid = Cell\n\nsetFilename(__dirname, __filename);\n\ntest('Each boid velocity should be independent', () => {\n  const lulas = createTestLulas({\n    behaviors: [move],\n    cells: [\n      createCell({ position: vector(10), velocity: vector(-1, -1) }),\n      createCell({ position: vector(20), velocity: vector(1) }),\n    ],\n  });\n\n  lulas.step();\n  const [first, second] = lulas.cells;\n\n  vectorAxis((axis) => equal(first.velocity[axis], -1));\n  vectorAxis((axis) => equal(second.velocity[axis], 1));\n});\n\ntest(\n  \"A boid should align to it's neighbors\",\n  [\n    [vector(0), vector(0, 1)],\n    // With vector(0) angle would be the same before and after (0)\n    [vector(1), vector(1, 0)],\n    [vector(0), vector(1)],\n    [vector(0), vector(-1, 0)],\n    [vector(0), vector(0, -1)],\n    [vector(0), vector(-1, -1)],\n  ],\n  (targetVel, neighborVel) => {\n    const lulas = createTestLulas({\n      behaviors: [alignementBehavior],\n      cells: [\n        createCell({ position: vector(10), velocity: { ...targetVel } }),\n        createCell({ position: vector(20), velocity: { ...neighborVel } }),\n      ],\n    });\n\n    const angleBefore = getAngle(targetVel);\n    const neighborAngle = getAngle(neighborVel);\n\n    lulas.step();\n    const sut = lulas.cells[0];\n\n    const angleAfter = getAngle(sut.velocity);\n    notEqual(angleAfter, angleBefore);\n    assertBetweenOrEqual(angleAfter, angleBefore, neighborAngle);\n  },\n);\n\ntest(\n  'A boid should get closer to nearby neighbors',\n  [\n    [vector(10)],\n    [vector(-10)],\n    [vector(15, -15)],\n    [vector(-15, 15)],\n    // out of range\n    // [vector(50), vector(0)],\n  ],\n  (pos) => {\n    const lulas = createTestLulas({\n      behaviors: [cohesionBehavior],\n      cells: [\n        createCell({ position: vector(0), velocity: vector(0), vision: 50 }),\n        createCell({ position: { ...pos }, velocity: vector(0) }),\n      ],\n    });\n\n    lulas.step();\n\n    const sut = lulas.cells[0];\n    const angleBefore = 0;\n    const angleAfter = getAngle(sut.velocity);\n\n    notEqual(angleAfter, angleBefore);\n    assertBetweenOrEqual(angleAfter, angleBefore, getAngle(pos));\n  },\n);\n\ntest(\n  'A boid should maintain distance from closer neighbors',\n  [\n    [vector(10)],\n    [vector(10, 5)],\n    [vector(-10)],\n    [vector(-5, -10)],\n    // out of range\n    // [vector(49), vector(0)],\n  ],\n  (pos) => {\n    // This checks if the cell position affects the direction\n    const cellPosition = vector(-100, 100);\n\n    const lulas = createTestLulas({\n      behaviors: [separationBehavior],\n      cells: [\n        createCell({ position: cellPosition, velocity: vector(0), vision: 50 }),\n        createCell({\n          position: sumVectors(cellPosition, pos),\n          velocity: vector(0),\n        }),\n      ],\n    });\n\n    lulas.step();\n\n    const sut = lulas.cells[0];\n    const angleBefore = 0;\n    const angleAfter = getAngle(sut.velocity);\n    let separationAngle = getAngle(pos) + 180;\n\n    if (separationAngle > 180) {\n      separationAngle -= 360;\n    }\n\n    notEqual(angleAfter, angleBefore);\n    assertBetweenOrEqual(angleAfter, angleBefore, separationAngle);\n  },\n);\n","import * as assert from 'assert';\n\nexport function assertBetween(\n  value: number,\n  first: number,\n  second: number,\n  message = '',\n) {\n  const min = Math.min(first, second);\n  const max = Math.max(first, second);\n  const finalMessage = `Expected ${value} to be between ${min} and ${max} (${message})`;\n\n  if (min === max) {\n    assert(value === min, finalMessage);\n    return;\n  }\n\n  assert(value > min, finalMessage);\n  assert(value < max, finalMessage);\n}\n\nexport function assertBetweenOrEqual(\n  value: number,\n  first: number,\n  second: number,\n  message = '',\n) {\n  const min = Math.min(first, second);\n  const max = Math.max(first, second);\n  const finalMessage = `Expected ${value} to be between ${min} and ${max} (${message})`;\n\n  if (min === max) {\n    assert(value === min, finalMessage);\n    return;\n  }\n\n  assert(value >= min, finalMessage);\n  assert(value <= max, finalMessage);\n}\n","import * as assert from 'assert';\n\nimport { solidBody } from '../src/behaviors/solidBody';\nimport { createCell } from '../src/cell';\nimport { vector, vectorAxis } from '../src/vector';\nimport { setFilename, test } from '../test/index';\nimport { createTestLulas } from '../test/test-duplicates';\n\nsetFilename(__dirname, __filename);\n\ntest(\n  'Cells should immediately separate each other if they overlap',\n  [\n    [vector(1, 0), vector(-1, 0), vector(5, 0)],\n    [vector(0, 1), vector(0, -1), vector(0, 5)],\n    [vector(1), vector(-1), vector(3.5355339059327378)],\n  ],\n  (pos1, pos2, expected) => {\n    const lulas = createTestLulas({\n      behaviors: [solidBody],\n      cells: [\n        createCell({ position: { ...pos1 }, velocity: vector(0) }),\n        createCell({ position: { ...pos2 }, velocity: vector(0) }),\n      ],\n    });\n\n    lulas.step();\n    const sut = lulas.cells[0];\n\n    vectorAxis((axis) => assert.equal(sut.position[axis], expected[axis]));\n  },\n);\n\ntest('Cells should stop if they collide on each other', () => {\n  const lulas = createTestLulas({\n    behaviors: [solidBody],\n    cells: [\n      createCell({ position: vector(1), velocity: vector(-1) }),\n      createCell({ position: vector(-1), velocity: vector(0) }),\n    ],\n  });\n\n  lulas.step();\n  const sut = lulas.cells[0];\n\n  vectorAxis((axis) => assert(sut.velocity[axis] >= 0));\n});\n"],"sourceRoot":""}